VLAN
--------

- VLAN（Virtual LAN）

- - PVID

  - - 交换机的任一接口都有一个 PVID

    - 标识了这个接口收到的数据应该交给哪个 VLAN

    - PVID 的范围是 0 ~ 4095 一共 4096 个

    - - VID = 0 表示不属于任何 VLAN，一般作为系统使用
      - VID = 1 为交换机的默认 PVID
      - VID = 4095 为协议保留值

  - access / untagged

  - - 一般用于连接电脑、打印机、无线路由器等终端设备

    - 数据处理

    - - 入方向

      - - 裸数据包打上与接口 PVID 相同的 TAG
        - 如果是已经有 TAG 的数据则直接丢弃

      - 出方向

      - - 剥离与接口 PVID 相同的 TAG
        - 如果与接口 PVID 不同则直接丢弃

  - trunk / tagged

  - - 一般用做连接交换机与交换机的物理链路

    - 数据处理

    - - 入方向

      - - 如果数据不带 TAG

        - - 打上与接口 PVID 相同的 TAG

        - 如果数据带有 TAG

        - - TAG 允许通过

          - - 接受并执行转发

          - TAG 不允许通过

          - - 丢弃数据

      - 出方向

      - - 如果带有与接口 PVID 相同的 TAG

        - - 剥离 TAG 后发送

        - 如果带有与接口 PVID 不同的 TAG

        - - TAG 允许通过

          - - 带原样 TAG 发出

          - TAG 不允许通过

          - - 丢弃数据

    - 常用配置模式

    - - 使用默认的 VLAN 1

      - - trunk 接口两端的 VLAN 需要一致
        - 如修改 PVID，则一般需要修改所有 trunk 接口的 PVID

      - 一般允许通过所有 VLAN

      - - 防止新增 VLAN 时修改所有的接口配置

  - 802.1q

  - - 经过 IEEE 认证的对数据帧附加 VLAN 识别信息的协议
    - 所附加的 VLAN 识别信息位于数据帧中共 4 个字节大小